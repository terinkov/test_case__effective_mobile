Проект «Система управления библиотекой»

- Основной скрипт main.py
- Файлы с кодом библиотек Library, Book находятся в папке src
- Файлы с unit-тестами находятся в папке tests

Обзор работы программы:

Пользователю предоставляется меню взаимодействия с библиотекой:

Меню:

1\. Добавить книгу

2\. Удалить книгу

3\. Найти книгу

4\. Отобразить все книги

5\. Изменить статус книги

6\. Выход

Введите номер операции: 

Далее пользователь действует набирая цифру операции и внося соответствующие значения полей, которые просят. Код проверяет данные, вводимые пользователем на корректность (нельзя ввести строку вместо числа, нельзя удалить несуществующую книгу и тд), выводя пользователю сообщения об ошибках, это реализовано с помощью обработки исключений.

![](Aspose.Words.cf20d2ba-f727-4cff-9401-a8731ff1ec01.001.png)

Код

Включает в себя классы Book, Library. Book отвечает за представление книги, содержит следующие параметры: 

- id - уникальный идентификатор книги
- title - название, длина от 0 до 256 символов
- author - автор, длина от 0 до 256 символов
- year - год выпуска, любое число
- status - выдана или в наличии

Функции класса Book:

- validate\_title – осуществляет проверку названия книги при создании экземпляра класса (должна быть не более 256 символов).
- validate\_author – осуществляет проверку строки автора книги при создании экземпляра класса (должна быть не более 256 символов).
- \_\_str\_\_ - функция для преобразования класса к строке. Возвращает представление класса в формате: "ID: {self.id}, Название: {self.title}, Автор: {self.author}, Год: {self.year}, Статус: {self.status}"
- \_\_init\_\_ - конструктор, с ID, title, author и годом издания. При создании экземпляра класса осуществляется проверка title и author полей на корректность. Если обнаружены невалидные поля вызывает BookTitleError или BookAuthorError соответственно.

Класс Library - представление библиотеки, позволяет работать с книгами находящимися в ней. Поля:

- **books** – переменная – список объектов Book, содержащая все книги со всеми полями.
- **book\_valid\_search\_fields** - список полей, по которым можно искать книги
- **valid\_book\_statuses** - список статусов книг (по условию "выдана" и "в наличии")

Функции класса Library:

- \_load\_books – protected функция, загружающая книги в переменную **books** из файла **library.json**.
- \_save\_books – «сохраняет» (dump) все книги находящиеся в текущий момент в переменной books в файл **library.json** в виде словарей
- \_generate\_book\_id – генерирует ID книги. Для этого выбирает наименьшее число большее 0, такое, что книги с этим ID нет.
- add\_book – создает экземпляр класса Book с переданными полями, добавляет этот экземпляр в переменную **book**, и вызывает функцию \_save\_books. Возвращает ID добавленной книги. Ошибки, которые возможно появились при создании экземпляра книги не обрабатывает, передавая их наверх.
- delete\_book – удаляет книгу по переданному в аргументе ID, сохраняет после удаления через \_save\_books. Возвращает если книга с таким ID не найдена, возвращает -1, иначе ID удаленной книги
- search\_book – Поиск книги по названию, автору или году издания. Возвращает список найденных по фильтру книг, если не нашли - пустой список. Если было передано неверное поле для поиска, вызывает *BookSearchFieldError.*
- check\_book\_presence\_by\_id – возвращает True если книга с заданным в аргументах ID есть в библиотеке
- get\_all\_books – просто возвращает переменную books
- change\_book\_status – меняет статус книги по указанному ID на указанный статус new\_status. Если new\_status некорректный (не “выдана” и не “в наличии”) – вызывает *BookStatusError.*
- delete\_all\_books – функция, удаляющая все книги из библиотеки, сохраняя данные. Возвращает количество удаленных книг.

Ошибки (Exceptions), обрабатываемые в программе:

- *BookTitleError* (наследует ValueError) - Возникает, когда название книги не соответствует ограничениям (слишком длинное).
- *BookAuthorError* (наследует ValueError) - Возникает, когда имя автора не соответствует ограничениям (слишком длинное).
- *GenerateIDError* (наследует IndexError) - Возникает, когда невозможно сгенерировать уникальный ID для книги (библиотека переполнена, количество книг уже больше MAX\_BOOKS\_COUNT).
- *BookStatusError* (наследует AttributeError) - Возникает, когда пытаются установить статус книги недопустимым значением.
- *BookSearchFieldError* (наследует ValueError) - Возникает, когда пытаются искать книгу по некорректному полю.
- *BookNotFoundError* (наследует ValueError) - Возникает, когда не удалось найти книгу по указанному ID.

Тесты:

Реализованы unit-тесты для классов Book и Library. 

Book:

1\. test\_book\_initialization\_valid() - проверяет корректную инициализацию объекта Book с валидными данными. Создает экземпляр Book с заданными ID, названием, автором и годом издания. Убеждается, что все атрибуты объекта имеют ожидаемые значения. Убеждается, что статус книги по умолчанию равен "в наличии" (book.status == "в наличии").

2\. test\_book\_initialization\_invalid\_title() - проверяет инициализацию объекта Book с некорректным названием книги (слишком длинным). Создает экземпляр Book с длинным названием, превышающим допустимую длину. Убеждается, что при инициализации объекта Book с некорректным названием возникает исключение BookTitleError.

3\. test\_book\_initialization\_invalid\_author() - проверяет инициализацию объекта Book с некорректным именем автора (слишком длинным). Создает экземпляр Book с длинным именем автора, превышающим допустимую длину. Убеждается, что при инициализации объекта Book с некорректным именем автора возникает исключение BookAuthorError.

4\. **test\_validate\_title\_valid**() - проверяет корректную работу метода validate\_title() для валидного названия книги. Создает экземпляр Book с корректным названием. Вызывает метод validate\_title() для проверки названия книги. Убеждается, что метод validate\_title() не вызывает исключений.

5\. **test\_validate\_title\_invalid**() - проверяет корректную работу метода validate\_title() для невалидного названия книги (слишком длинного). Создает экземпляр Book с некорректным названием. Вызывает метод validate\_title() для проверки названия книги. Убеждается, что при вызове метода validate\_title() возникает исключение BookTitleError.

6\. **test\_validate\_author\_valid**() - Проверяет корректную работу метода validate\_author() для валидного имени автора. Создает экземпляр Book с корректным именем автора. Вызывает метод validate\_author() для проверки имени автора. Убеждается, что метод validate\_author() не вызывает исключений.

7\. **test\_validate\_author\_invalid**() - проверяет корректную работу метода validate\_author() для невалидного имени автора (слишком длинного). Создает экземпляр Book с некорректным именем автора. Вызывает метод validate\_author() для проверки имени автора. Убеждается, что при вызове метода validate\_author() возникает исключение BookAuthorError.

8\. **test\_str\_representation**() - проверяет правильность строкового представления объекта Book.

Library:

1\. test\_delete\_all\_books() - проверяет удаление всех книг из библиотеки. Добавляет две книги в библиотеку. Вызывает метод delete\_all\_books() для удаления всех книг. Убеждается, что после удаления в библиотеке нет ни одной книги (len(self.library.books) == 0).

2\. test\_add\_book() - проверяет добавление книги в библиотеку. Удаляет все книги из библиотеки. Добавляет книгу с помощью метода add\_book(). Убеждается, что в библиотеке теперь одна книга (len(self.library.books) == 1). Убеждается, что ID добавленной книги равен 1 (self.library.books[0].id == 1).

3\. test\_delete\_book() - проверяет удаление книги из библиотеки. Удаляет все книги из библиотеки. Добавляет книгу в библиотеку. Вызывает метод delete\_book() для удаления книги с ID 1. Убеждается, что после удаления в библиотеке нет ни одной книги (len(self.library.books) == 0).
